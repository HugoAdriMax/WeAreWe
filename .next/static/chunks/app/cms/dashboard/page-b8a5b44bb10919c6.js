(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[679],{5640:(e,r,s)=>{Promise.resolve().then(s.bind(s,8685))},8685:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>w});var t=s(5155),a=s(2115),l=s(2615),i=s(6046),n=s(7711),c=s(1902),o=s(1719),d=s(4081),m=s(2423),x=s(2316),h=s(3473),g=s(853),u=s(3230),p=s(8701),j=s(2598),v=s(3580),f=s(5686),b=s(5565);let N=(0,n.default)(()=>s.e(726).then(s.bind(s,3726)),{loadableGenerated:{webpack:()=>[3726]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"animate-pulse bg-gray-200 h-96 rounded-lg flex items-center justify-center",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Chargement de l'\xe9diteur..."})})}),y=e=>{let{title:r,value:s,icon:a,trend:l}=e;return(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow hover:shadow-md transition-all duration-300",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:r}),(0,t.jsx)("div",{className:"text-gray-400",children:a})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s}),void 0!==l&&(0,t.jsxs)("div",{className:"flex items-center ".concat(l>=0?"text-green-500":"text-red-500"),children:[l>=0?(0,t.jsx)(c.A,{className:"w-4 h-4"}):(0,t.jsx)(o.A,{className:"w-4 h-4"}),(0,t.jsxs)("span",{className:"text-sm",children:[Math.abs(l),"%"]})]})]})]})};function w(){let{data:e,status:r}=(0,l.useSession)(),s=(0,i.useRouter)(),[n,c]=(0,a.useState)([]),[o,w]=(0,a.useState)(!0),[k,C]=(0,a.useState)(null),[A,D]=(0,a.useState)(""),[S,E]=(0,a.useState)(!1),[L,_]=(0,a.useState)(null),[M,U]=(0,a.useState)("list"),[T,P]=(0,a.useState)("all"),[R,z]=(0,a.useState)("desc");(0,a.useEffect)(()=>{"unauthenticated"===r&&s.push("/cms/login")},[r,s]),(0,a.useEffect)(()=>{F()},[]);let F=async()=>{try{w(!0);let e=await fetch("/api/articles");if(!e.ok)throw Error("Erreur lors du chargement des articles");let r=await e.json();c(r),_(null)}catch(e){_("Erreur lors du chargement des articles"),console.error("Erreur:",e)}finally{w(!1)}},O=async e=>{if(confirm("\xcates-vous s\xfbr de vouloir supprimer cet article ?"))try{if(!(await fetch("/api/articles/".concat(e),{method:"DELETE"})).ok)throw Error("Erreur lors de la suppression");c(n.filter(r=>r._id!==e)),_(null)}catch(e){_("Erreur lors de la suppression"),console.error("Erreur:",e)}},I=async()=>{if(k){E(!0);try{let e=k._id?"PUT":"POST",r=k._id?"/api/articles/".concat(k._id):"/api/articles";if(!(await fetch(r,{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify({...k,date:k.date||new Date().toISOString(),author:k.author||"Admin"})})).ok)throw Error("Erreur lors de la sauvegarde");await F(),C(null),_(null)}catch(e){_("Erreur lors de la sauvegarde"),console.error("Erreur:",e)}finally{E(!1)}}},V=e=>{window.open("/article/".concat(e.slug),"_blank")},B=n.filter(e=>{let r=e.title.toLowerCase().includes(A.toLowerCase())||e.metaDescription.toLowerCase().includes(A.toLowerCase());return"recent"===T?r&&new Date(e.date||"").getMonth()===new Date().getMonth():"images"===T?r&&e.imageUrl:r}).sort((e,r)=>{let s=new Date(e.date||"").getTime(),t=new Date(r.date||"").getTime();return"asc"===R?s-t:t-s}),G=()=>{var e;let r=n.length,s=n.filter(e=>new Date(e.date||"").getMonth()===new Date().getMonth()).length,t=n.filter(e=>e.imageUrl).length,a=(null===(e=n[0])||void 0===e?void 0:e.date)?new Date(n[0].date).toLocaleDateString("fr-FR"):"-",l=n.filter(e=>{let r=new Date(e.date||""),s=new Date;return s.setMonth(s.getMonth()-1),r.getMonth()===s.getMonth()}).length;return{total:r,thisMonth:s,withImages:t,lastPublished:a,trend:l?(s-l)/l*100:0}};return"loading"===r||o?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-primary",children:(0,t.jsx)("div",{className:"sr-only",children:"Chargement..."})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto p-4 sm:p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6",children:[(0,t.jsx)(y,{title:"Total Articles",value:G().total,icon:(0,t.jsx)(d.A,{className:"w-6 h-6"})}),(0,t.jsx)(y,{title:"Ce mois",value:G().thisMonth,icon:(0,t.jsx)(m.A,{className:"w-6 h-6"}),trend:G().trend}),(0,t.jsx)(y,{title:"Derni\xe8re publication",value:G().lastPublished,icon:(0,t.jsx)(m.A,{className:"w-6 h-6"})}),(0,t.jsx)(y,{title:"Articles avec images",value:G().withImages,icon:(0,t.jsx)(x.A,{className:"w-6 h-6"})})]}),L&&(0,t.jsx)("div",{className:"animate-fadeIn bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,t.jsx)("div",{className:"ml-3",children:(0,t.jsx)("p",{className:"text-sm",children:L})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg",children:k?(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center border-b border-gray-100 pb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:k._id?"Modifier l'article":"Nouvel article"}),(0,t.jsx)("button",{onClick:()=>C(null),className:"text-gray-500 hover:text-gray-700 transition-colors",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titre"}),(0,t.jsx)("input",{type:"text",value:k.title,onChange:e=>C({...k,title:e.target.value,slug:e.target.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-shadow",placeholder:"Titre de l'article"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug"}),(0,t.jsx)("input",{type:"text",value:k.slug,onChange:e=>C({...k,slug:e.target.value}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-shadow",placeholder:"slug-de-l-article"})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Meta Description"}),(0,t.jsx)("textarea",{value:k.metaDescription,onChange:e=>C({...k,metaDescription:e.target.value}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-shadow",rows:3,placeholder:"Description pour les moteurs de recherche"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL de l'image"}),(0,t.jsx)("input",{type:"text",value:k.imageUrl,onChange:e=>C({...k,imageUrl:e.target.value}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-shadow",placeholder:"https://exemple.com/image.jpg"}),k.imageUrl&&(0,t.jsx)("div",{className:"mt-2 relative",children:(0,t.jsx)("div",{className:"relative w-full aspect-video rounded-lg overflow-hidden",children:(0,t.jsx)(b.default,{src:k.imageUrl,alt:"Aper\xe7u",fill:!0,className:"object-cover"})})})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contenu"}),(0,t.jsx)(N,{initialValue:k.content,onSave:e=>C({...k,content:e})})]}),(0,t.jsxs)("div",{className:"flex justify-end items-center space-x-4 pt-6 border-t border-gray-100",children:[(0,t.jsx)("button",{onClick:()=>C(null),className:"px-6 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",disabled:S,children:"Annuler"}),(0,t.jsx)("button",{onClick:I,disabled:S,className:"px-6 py-2.5 bg-primary text-white rounded-lg hover:bg-primary/90  transition-colors flex items-center gap-2 disabled:opacity-50",children:S?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),(0,t.jsx)("span",{children:"Sauvegarde..."})]}):(0,t.jsx)("span",{children:"Sauvegarder"})})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"p-6 border-b border-gray-100",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["Articles ",(0,t.jsxs)("span",{className:"text-primary",children:["(",B.length,")"]})]})}),(0,t.jsxs)("button",{onClick:()=>C({_id:"",title:"",slug:"",metaDescription:"",imageUrl:"",content:"",author:"Admin"}),className:"flex items-center justify-center gap-2 bg-primary text-white px-4 py-2  rounded-lg hover:bg-primary/90 transition-colors shadow-sm hover:shadow",children:[(0,t.jsx)(h.A,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:"Nouvel Article"})]})]}),(0,t.jsxs)("div",{className:"mt-6 flex flex-col sm:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(g.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,t.jsx)("input",{type:"text",placeholder:"Rechercher un article...",value:A,onChange:e=>D(e.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2  focus:ring-primary focus:border-transparent transition-shadow"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>U("grid"),className:"p-2.5 rounded-lg transition-colors ".concat("grid"===M?"bg-primary text-white":"text-gray-400 hover:bg-gray-100"),title:"Vue grille",children:(0,t.jsx)(u.A,{className:"w-5 h-5"})}),(0,t.jsx)("button",{onClick:()=>U("list"),className:"p-2.5 rounded-lg transition-colors ".concat("list"===M?"bg-primary text-white":"text-gray-400 hover:bg-gray-100"),title:"Vue liste",children:(0,t.jsx)(p.A,{className:"w-5 h-5"})})]})]}),(0,t.jsx)("div",{className:"mt-6 flex flex-wrap gap-2",children:["all","recent","images"].map(e=>(0,t.jsxs)("button",{onClick:()=>P(e),className:"px-4 py-2 rounded-lg transition-colors ".concat(T===e?"bg-primary text-white shadow-sm":"text-gray-600 hover:bg-gray-100"),children:["all"===e&&"Tous les articles","recent"===e&&"Articles r\xe9cents","images"===e&&"Avec images"]},e))})]}),(0,t.jsxs)("div",{className:"overflow-hidden",children:["grid"===M?(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 p-6",children:B.map(e=>(0,t.jsxs)("div",{className:"group bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[(0,t.jsxs)("div",{className:"relative aspect-video",children:[(0,t.jsx)(b.default,{src:e.imageUrl,alt:e.title,fill:!0,className:"object-cover transition-transform duration-300 group-hover:scale-105"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/0 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),(0,t.jsxs)("div",{className:"p-5",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg text-gray-900 mb-2 line-clamp-2 group-hover:text-primary transition-colors",children:e.title}),(0,t.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2 mb-4",children:e.metaDescription}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("time",{className:"text-xs text-gray-400",children:new Date(e.date||"").toLocaleDateString("fr-FR")}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>V(e),className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-lg transition-all",title:"Pr\xe9visualiser",children:(0,t.jsx)(j.A,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>C(e),className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-lg transition-all",title:"\xc9diter",children:(0,t.jsx)(v.A,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>O(e._id),className:"p-2 text-red-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Supprimer",children:(0,t.jsx)(f.A,{className:"w-4 h-4"})})]})]})]})]},e._id))}):(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:B.map(e=>(0,t.jsx)("div",{className:"group p-6 hover:bg-gray-50 transition-colors cursor-pointer",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-6",children:[(0,t.jsx)("div",{className:"relative w-full sm:w-48 aspect-video rounded-lg overflow-hidden flex-shrink-0",children:(0,t.jsx)(b.default,{src:e.imageUrl,alt:e.title,fill:!0,className:"object-cover transition-transform duration-300 group-hover:scale-105"})}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg text-gray-900 mb-2 line-clamp-1 group-hover:text-primary transition-colors",children:e.title}),(0,t.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2 mb-4",children:e.metaDescription}),(0,t.jsxs)("div",{className:"mt-auto flex flex-wrap items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("time",{className:"text-sm text-gray-400",children:new Date(e.date||"").toLocaleDateString("fr-FR")}),(0,t.jsx)("span",{className:"h-1 w-1 bg-gray-300 rounded-full"}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:e.author||"Admin"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:r=>{r.stopPropagation(),V(e)},className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-lg transition-colors",title:"Pr\xe9visualiser",children:(0,t.jsx)(j.A,{className:"w-5 h-5"})}),(0,t.jsx)("button",{onClick:r=>{r.stopPropagation(),C(e)},className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-lg transition-colors",title:"\xc9diter",children:(0,t.jsx)(v.A,{className:"w-5 h-5"})}),(0,t.jsx)("button",{onClick:r=>{r.stopPropagation(),O(e._id)},className:"p-2 text-red-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Supprimer",children:(0,t.jsx)(f.A,{className:"w-5 h-5"})})]})]})]})})]})},e._id))}),0===B.length&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[(0,t.jsx)("div",{className:"text-gray-400 mb-4",children:(0,t.jsx)(d.A,{className:"w-12 h-12"})}),(0,t.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:A?"Aucun article ne correspond \xe0 votre recherche":"Aucun article"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:A?"Essayez d'autres termes de recherche":"Commencez par cr\xe9er votre premier article"})]})]})]})})]})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[970,615,668,441,517,358],()=>r(5640)),_N_E=e.O()}]);